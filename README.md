
权限组网址：
http://blog.csdn.net/u013277740/article/details/51647791

要点：
1、危险权限组要点：只要已经有一个危险权限已经被授权，那么同组的危险权限只需要在功能清单中配置了就可以得到授权，不用再次调用请求权限的方法就已经被授权了，只需简单地配置到功能清单。
2、如果不配置功能清单的话这个权限还是不会被授权了，权限组的意义仅此而已， 跟是否必须整个组一起请求没关系。完全可以单独请求，而且每个权限都是独立使用的，权限组，只是说明一件事，那就是如果组内有被授权的权限，那么别的权限只用配置功能清单就可使用。（已验证）
3、请求权限的API
ContextCompat.checkSelfPermission   
ActivityCompat.requestPermissions
ActivityCompat.shouldShowRequestPermissionRationale     只有当用户勾选了不要再询问之，这个值才返回false；
这几个API是v4包中的，已经兼容了6.0以下的SDK，所以不用单独做是否是6.0的判断，因为所有运行在6.0以下机型的危险权限 ，ContextCompat.checkSelfPermission 都会返回true；
如果用context.checkSelfPermission的话就需要对SDK版本做判断了，所以直接用上面的API就行，把SDK都当成是6.0就可以，就不用对SDK版本做额外的判断了。

/如果是6.0以下的手机，ActivityCompat.checkSelfPermission()会始终等于PERMISSION_GRANTED，   但是，如果用户关闭了你申请的权限，ActivityCompat.checkSelfPermission(),会导致程序崩溃(java.lang.RuntimeException: Unknown exception code: 1 msg null)，  
  1.  你可以使用try{}catch(){},处理异常，也可以在这个地方，低于23就什么都不做，  
  2.  个人建议try{}catch(){}单独处理，提示用户开启权限。


4、用户勾选了不再提示，允许的按钮就不能点了，权限也肯定被拒绝了，这个时候再请求权限是不会弹窗的，但是每次请求权限还是会有结果回调的，所以不用担心点击事件每次请求权限会弹窗影响用户体验，直接在点击事件里面每次检查权限、没权限直接请求权限就行
用户如果勾选不再询问，以后再申请这个权限就不会弹出这个权限的请求窗口了。但是有回调
只有用户拒绝过一次权限，下一次再请求该权限，才会出现不在询问这个按钮，所以第一次用户拒绝shouldShowRequestPermissionRationale肯定返回true，我们完全有机会根据shouldShowRequestPermissionRationale返回true，去解释一下为什么要用这个权限
5、6.0动态权限代码流程 （以点击打开相机为例）
       （1）点击事件里面只检查权限，如果没有就请求权限，如果有打开相机，别的什么都不做，而且也不要加别的限制，而且是不会影响用户体验的，每次都去请求就行，即使用户勾选了不再提醒也没关系，直接请求权限就行，原因看第4条
       （2）在结果会调中如果权限没有被允许，就去判断用户是否勾选了不再询问，根据
shouldShowRequestPermissionRationale的返回值判断，返回false就是勾选了
根据不同的返回值，弹不同的提示框，有两种弹窗， 解释权限弹窗和是否跳转设置页面弹窗。 其中解释权限弹窗用户点确定后就跳转到是否跳转设置页面弹窗
if（没勾选不再询问）{
是否跳转设置页面的弹窗弹出 -->点击确定后-->跳转到系统设置页面
}else{
解释权限弹窗弹出 -->点击确定后 -->是否跳转设置页面的弹窗弹出- ->点击确定后-->跳转到系统设置页面
}
（3）用户从设置页面返回之后，无论是否授权返回码都不是ok，所以直接在这里面再次根据请求吗，检查对应的权限是否授权，授权就做操作，没授权就不做任何操作了

6、用户是否勾选不再询问之后，可以有很多方案去做，
1、可以是上面的方案
2、可以不管他是否勾选每次都弹出设置页面的弹窗 
3、也可以只有用户没勾选的时候弹设置页面的弹窗，勾选了就不再弹任何东西，但是这样用户再点击按钮会没有任何弹窗出现，给用户的感觉是点击没反应，用户的体验也不是特别的好，其实到底如何就看产品的需求了。默认用最上面的那种就行了
4、还有一种解决方案是，
如果shouldShowRequestPermissionRationale返回true
直接解释权限弹窗弹出 -->点击确定后 -->是否跳转设置页面的弹窗弹出- ->点击确定后-->跳转到系统设置页面
如果shouldShowRequestPermissionRationale返回false
直接Toast告诉用户缺乏那些权限，因为用户可能不想再看到弹窗了，这是从产品角度考虑的。

